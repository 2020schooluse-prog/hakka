<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®¢èªé–±è®€æŒ‘æˆ°è³½ - ğŸŒ¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ffb7c5; /* æ«»èŠ±ç²‰ */
            --correct: #4caf50; /* ç­”å°ç¶  */
            --wrong: #f44336;   /* ç­”éŒ¯ç´… */
        }

        body, html {
            height: 100%; margin: 0;
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(rgba(255,255,255,0.2), rgba(255,255,255,0.2)), 
                        url('https://images.unsplash.com/photo-1522383225653-ed111181a951?q=80&w=2070&auto=format&fit=crop') no-repeat center center fixed;
            background-size: cover;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }

        .quiz-container {
            width: 90%; max-width: 650px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            padding: 25px; border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border: 2px solid white; text-align: center;
            transition: transform 0.2s;
        }

        h1 { color: #d63384; font-size: 1.6rem; margin: 0 0 15px 0; }

        .progress-bar {
            width: 100%; background: #eee; height: 10px;
            border-radius: 10px; margin-bottom: 20px; overflow: hidden;
        }

        #progress-inner {
            height: 100%; background: linear-gradient(90deg, #ffb7c5, #d63384);
            width: 0%; transition: width 0.4s ease;
        }

        #question-text {
            font-size: 1.3rem; min-height: 70px; margin-bottom: 20px;
            color: #333; line-height: 1.5; font-weight: 700;
        }

        .options-grid {
            display: grid; grid-template-columns: 1fr; gap: 10px;
        }

        @media (min-width: 500px) {
            .options-grid { grid-template-columns: 1fr 1fr; }
        }

        .option-btn {
            background: white; border: 2px solid var(--primary);
            padding: 12px; border-radius: 12px; font-size: 1.05rem;
            cursor: pointer; transition: all 0.2s; color: #444;
        }

        /* ç­”å°èˆ‡ç­”éŒ¯çš„æ¨£å¼ */
        .correct { background-color: var(--correct) !important; color: white !important; border-color: #2e7d32 !important; }
        .wrong { background-color: var(--wrong) !important; color: white !important; border-color: #c62828 !important; }
        .disabled { pointer-events: none; opacity: 0.8; }

        /* ç­”éŒ¯éœ‡å‹•å‹•ç•« */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-6px); }
            75% { transform: translateX(6px); }
        }
        .shake { animation: shake 0.3s ease-in-out 2; }

        #result-screen { display: none; }
        .score-val { font-size: 2.5rem; color: #d63384; font-weight: bold; margin: 10px 0; }
        
        button.retry-btn {
            margin-top: 15px; background: #4a90e2; color: white;
            border: none; padding: 10px 25px; border-radius: 50px; cursor: pointer;
        }
    </style>
</head>
<body>

<div class="quiz-container" id="main-box">
    <div id="game-screen">
        <h1>ğŸŒ¸ å®¢èªé–±è®€æŒ‘æˆ°è³½ ğŸŒ¸</h1>
        <div class="progress-bar">
            <div id="progress-inner"></div>
        </div>
        <div id="question-text">è¼‰å…¥é¡Œç›®ä¸­...</div>
        <div id="options" class="options-grid"></div>
    </div>

    <div id="result-screen">
        <h2>æ¸¬é©—å®Œæˆï¼</h2>
        <div class="score-val" id="score-text">0</div>
        <p>åšå¾—çœŸæ…¶ï¼(è¡¨ç¾å¾—å¾ˆå¥½ï¼)</p>
        <button class="retry-btn" onclick="location.reload()">é‡æ–°æŒ‘æˆ°</button>
    </div>
</div>

<script>
    let questions = [];
    let currentIdx = 0;
    let score = 0;
    let isLocked = false;

    async function start() {
        try {
            const resp = await fetch('questions.json');
            if (!resp.ok) throw new Error();
            const data = await resp.json();
            // éš¨æ©Ÿé¸ 15 é¡Œ
            questions = data.sort(() => Math.random() - 0.5).slice(0, 15);
            render();
        } catch (e) {
            document.getElementById('question-text').innerText = "âŒ ç„¡æ³•è®€å–é¡Œåº« (éœ€é€é Server é–‹å•Ÿ)";
        }
    }

    function render() {
        if (currentIdx >= questions.length) {
            showEnd();
            return;
        }

        isLocked = false;
        const q = questions[currentIdx];
        const box = document.getElementById('main-box');
        box.classList.remove('shake');

        document.getElementById('question-text').innerText = `${currentIdx + 1}. ${q.q}`;
        document.getElementById('progress-inner').style.width = (currentIdx / questions.length * 100) + "%";

        const optDiv = document.getElementById('options');
        optDiv.innerHTML = "";

        q.a.forEach((txt, i) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = txt;
            btn.onclick = () => check(i, btn);
            optDiv.appendChild(btn);
        });
    }

    function check(picked, btn) {
        if (isLocked) return;
        isLocked = true;

        const correct = questions[currentIdx].ans;
        const allBtns = document.querySelectorAll('.option-btn');
        const box = document.getElementById('main-box');

        allBtns.forEach(b => b.classList.add('disabled'));

        if (picked === correct) {
            score++;
            btn.classList.add('correct');
        } else {
            btn.classList.add('wrong');
            allBtns[correct].classList.add('correct');
            box.classList.add('shake');
        }

        setTimeout(() => {
            currentIdx++;
            render();
        }, 1200);
    }

    function showEnd() {
        document.getElementById('game-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        document.getElementById('score-text').innerText = `${score} / ${questions.length}`;
        document.getElementById('progress-inner').style.width = "100%";
    }

    start();
</script>

</body>
</html>
